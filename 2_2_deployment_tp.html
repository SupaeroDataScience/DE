
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Data Engineering class at ISAE-Supaero as part of the SDD program">
      
      
      
        <link rel="canonical" href="https://supaerodatascience.github.io/DE/2_2_deployment_tp.html">
      
      
        <link rel="prev" href="2_2_deployment.html">
      
      
        <link rel="next" href="2_2_deployment_tp_long.html">
      
      
      <link rel="icon" href="https://raw.githubusercontent.com/SupaeroDataScience/DE/master/src/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>TP - Data Engineering</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deploy-your-ml-model-into-production" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Data Engineering" class="md-header__button md-logo" aria-label="Data Engineering" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/SupaeroDataScience/DE/master/src/favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Data Engineering
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              TP
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/SupaeroDataScience/DE" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SupaeroDataScience/DE
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Data Engineering" class="md-nav__button md-logo" aria-label="Data Engineering" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/SupaeroDataScience/DE/master/src/favicon.ico" alt="logo">

    </a>
    Data Engineering
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/SupaeroDataScience/DE" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SupaeroDataScience/DE
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Overview
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syllabus
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    DE Fundamentals
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            DE Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ctf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CTF
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Data Storage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Data Storage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="0_1_databases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="0_2_postgres.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PostgreSQL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Data Computation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Data Computation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_1_overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cloud Computing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Cloud Computing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_2_cloud.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lectures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_2_gcp_handson.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Containers, Docker
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Containers, Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_3_containers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_3_docker_tp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_4_be.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Google Cloud and Docker BE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_5_conclusion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recap Cloud & Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_7_readings.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reading List
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Data Distribution
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Data Distribution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_1_overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deployment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_2_deployment.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lectures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    TP
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="2_2_deployment_tp.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    TP
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objectifs" class="md-nav__link">
    <span class="md-ellipsis">
      Objectifs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-mise-en-place-du-projet-google-cloud-platform" class="md-nav__link">
    <span class="md-ellipsis">
      1 - Mise en place du projet Google Cloud Platform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-demarrage-du-code-space" class="md-nav__link">
    <span class="md-ellipsis">
      2 - Démarrage du Code Space
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-construction-et-tests-du-backend" class="md-nav__link">
    <span class="md-ellipsis">
      3 - Construction et tests du backend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-construction-et-tests-du-frontend" class="md-nav__link">
    <span class="md-ellipsis">
      4 - Construction et tests du frontend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      5 - docker-compose
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-deploiement-du-backend-sur-une-vm-google-compute-engine" class="md-nav__link">
    <span class="md-ellipsis">
      6 - Deploiement du backend sur une VM Google Compute Engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-tests" class="md-nav__link">
    <span class="md-ellipsis">
      7 - Tests
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-yay" class="md-nav__link">
    <span class="md-ellipsis">
      8. Yay !
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_2_deployment_tp_long.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TP (Version Longue)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kubernetes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_3_kub_intro.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_4_functional.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Programming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_5_mapreduce.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hadoop and MapReduce
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_6_spark.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_8_dask.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dask on Kubernetes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_9_project.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dask project
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objectifs" class="md-nav__link">
    <span class="md-ellipsis">
      Objectifs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-mise-en-place-du-projet-google-cloud-platform" class="md-nav__link">
    <span class="md-ellipsis">
      1 - Mise en place du projet Google Cloud Platform
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-demarrage-du-code-space" class="md-nav__link">
    <span class="md-ellipsis">
      2 - Démarrage du Code Space
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-construction-et-tests-du-backend" class="md-nav__link">
    <span class="md-ellipsis">
      3 - Construction et tests du backend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-construction-et-tests-du-frontend" class="md-nav__link">
    <span class="md-ellipsis">
      4 - Construction et tests du frontend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      5 - docker-compose
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-deploiement-du-backend-sur-une-vm-google-compute-engine" class="md-nav__link">
    <span class="md-ellipsis">
      6 - Deploiement du backend sur une VM Google Compute Engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-tests" class="md-nav__link">
    <span class="md-ellipsis">
      7 - Tests
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-yay" class="md-nav__link">
    <span class="md-ellipsis">
      8. Yay !
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="deploy-your-ml-model-into-production">Deploy your ML model into production<a class="headerlink" href="#deploy-your-ml-model-into-production" title="Permanent link">🔗</a></h1>
<h2 id="objectifs">Objectifs<a class="headerlink" href="#objectifs" title="Permanent link">🔗</a></h2>
<p>L'objectif du TP est de convertir <a href="https://colab.research.google.com/drive/1YnJVW-IbMkUhl7s5nJ7BsT5tsTTvMmUB?usp=sharing">ce notebook</a> en deux services containerisés : Un back-end qui est un serveur qui reçoit des images et sort des prédictions, ainsi qu'un front-end qui vous permet d'envoyer des images au modèle et d'afficher les prédictions sur lesdites images,</p>
<p>Afin de gagner du temps, les dockerfiles ont déjà été construits et sont prêts à être testés et déployés. Si vous souhaitez rentrer dans les détails et écrire vous-même le code, vous pouvez consulter la version longue de ce TP (qui n'est pas à jour). </p>
<p>Nous allons donc voir :
- La création d'un docker "backend" qui contient le modèle derrière une "API"
- L'interaction avec ce docker
- La création d'un docker "frontend" qui contient une IHM permettant d'interagir plus facilement avec le backend
- docker-compose pour lancer des applications multi-container
- Le déploiement du backend sur GCP
- Le test final</p>
<p>Nous nous plaçons dans un contexte "microservices" où le front-end et le backend sont 2 containers différents. Il aurait été possible de n'en faire qu'un qui contient les deux (un "monolithe"). Une architecture microservices peut avoir certains avantages (modularité, maintenance) mais est plus complexe à mettre en oeuvre.</p>
<h2 id="1-mise-en-place-du-projet-google-cloud-platform">1 - Mise en place du projet Google Cloud Platform<a class="headerlink" href="#1-mise-en-place-du-projet-google-cloud-platform" title="Permanent link">🔗</a></h2>
<p>Maintenant que vous avez vos crédits, suivez les instructions du <a href="https://supaerodatascience.github.io/DE/1_2_gcp_handson.html#1a-create-your-gcp-account">1er TP Google Cloud Platform</a> pour créer votre propre projet GCP </p>
<h2 id="2-demarrage-du-code-space">2 - Démarrage du Code Space<a class="headerlink" href="#2-demarrage-du-code-space" title="Permanent link">🔗</a></h2>
<p>Démarrez un github codespace depuis le repository <a href="https://github.com/fchouteau/isae-cloud-computing-codespace">https://github.com/fchouteau/isae-cloud-computing-codespace</a></p>
<p>Il est nécéssaire d'utiliser un codespace à partir de ce repository car il contient tout ce dont vous avez besoin pour ce TP.</p>
<p><img alt="codespace" src="slides/static/img/codespacefchouteau.png" /></p>
<p>Normalement, une fois le codespace lancé, vous devriez obtenir une interface vscode avec deux dossiers dont un nommé <code>tp-deployment</code>. Rendez-vous dans ce dossier,</p>
<p>Il y a plusieurs ressources : le <code>frontend</code> qui contient de quoi construire l'IHM, le <code>backend</code> qui contient de quoi construire le serveur, et des ressources de tests.</p>
<h2 id="3-construction-et-tests-du-backend">3 - Construction et tests du backend<a class="headerlink" href="#3-construction-et-tests-du-backend" title="Permanent link">🔗</a></h2>
<p>Le <code>README.md</code> du dossier <code>backend</code> contient des détails concernant la construction du serveur et de son API (qui était auparavant laissé en exercice). Nous utilisons <a href="https://fastapi.tiangolo.com/">FastAPI</a> qui un framework de construction d'applications Web.</p>
<p>Le code principal se trouve dans <code>app.py</code>. On déclare des "routes" (des méthodes d'interactions avec le serveur) puis on leur assigne des fonctions.</p>
<p>Par exemple, vous pouvez regarder la route <code>predict</code> qui est associée à la fonction du même nom.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="s2">&quot;/predict&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Send a base64 encoded image + the model name, get detections&quot;</span><span class="p">,</span>
    <span class="n">response_description</span><span class="o">=</span><span class="s2">&quot;Detections + Processing time&quot;</span><span class="p">,</span>
    <span class="n">response_model</span><span class="o">=</span><span class="n">Result</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<p>Cette fonction effectue l'inférence sur l'image qui est donnée via la requête REST vers la route /predict.</p>
<p>Afin de mieux illustrer les possibilités d'intéraction avec ce serveur, nous allons le lancer localement, en utilisant l'image docker déjà construite (Remarque: vous pouvez reproduire le docker en lançant <code>docker build -f Dockerfile -t eu.gcr.io/third-ridge-138414/yolo-v5:1.2</code>)</p>
<p>Lancez la commande suivante <code>docker run --rm -p 8000:8000 eu.gcr.io/third-ridge-138414/yolo-v5:1.2</code></p>
<p>Cela lance un container depuis l'image docker du backend en exposant le port 8000.</p>
<p>Connectez-vous au port 8000 du codespace. Vous devriez avoir une page vierge qui contient <code>"YOLO-V5 WebApp created with FastAPI"</code></p>
<p>Nous allons maintenant regarder la documentation de l'application. Celle-ci est automatiquement générée à partir du code de <code>app.py</code> et est disponible sur la route <code>/docs</code> </p>
<p>Connectez-vous donc à la route <code>/docs</code> en rajoutant ce terme à l'URL du codespace. </p>
<p><img alt="fastapidoc" src="slides/static/img/apidoc.png" /></p>
<p>Cette page web décrit les différentes routes accessibles et leurs méthodes d'intéraction, ainsi que les formats d'entrée et de sortie. C'est la documentation de l'API et lorsque vous interagissez avec le serveur, c'est la seule chose dont vous avez besoin.</p>
<p>Nous allons maintenant interagir avec ce serveur.</p>
<p>Dans le dossier <code>backend</code> se trouve un fichier python <code>test_webapp.py</code>. Il va automatiquement envoyer les bonnes requêtes au serveur. Executez-le (<code>python test_webapp.py</code>), vous devriez voir s'afficher des tests correspondants au code, ainsi que les prédictions des chats sur l'image <code>cats.png</code> </p>
<p>Laissez le terminal avec le container démarré pour l'instant,</p>
<h2 id="4-construction-et-tests-du-frontend">4 - Construction et tests du frontend<a class="headerlink" href="#4-construction-et-tests-du-frontend" title="Permanent link">🔗</a></h2>
<p>Comme vous aurez pu le constater, ce n'est pas très intuitif d'interagir avec le backend via des scripts, on aimerait pouvoir visualiser plus facilement les prédictions, faire des seuils sur la confiance des objets, etc...</p>
<p>Pour cela nous allons créer une application <code>streamlit</code> (remarque: pour une introduction à streamlit rendez-vous dans la <a href="https://supaerodatascience.github.io/DE/1_4_be.html#6-lets-discover-streamlit">section 6 du BE</a>)</p>
<p>Dans votre codespace, démarrez un nouveau terminal puis allez dans le dossier <code>frontend</code>. Là encore, le fichier <code>app.py</code> contient le code de l'applicaiton streamlit. Celle-ci va récupérer une image que vous allez uploader (image de votre choix) puis l'envoyer au serveur dont vous spécifiez l'IP dans la case en haut à gauche.</p>
<p>Nous allons lancer cette application,</p>
<p><code>docker run --rm -p 8501:8501 --network="host" eu.gcr.io/third-ridge-138414/yolo-v5-streamlit:1.5</code></p>
<p>Rendez-vous sur le port 8501 de votre github codespace, </p>
<p><img alt="streamlit" src="slides/static/img/companionapp.png" /></p>
<p>La première étape est de renseigner l'adresse (URL) du backend. Pour tester que vous arrivez bien à joindre le serveur, cliquez sur le bouton "IS ALIVE". Ce bouton (voir code dans <code>app.py</code>) envoie une requête à la route /health pour vérifier que le serveur est vivant.</p>
<p>Par défaut, l'URL du serveur est <code>http://localhost:8000</code> ce qui semble correct car nous avons ouvert un docker sur le port 8000.</p>
<p>Vous pouvez maintenant tester le serveur, et s'il marche, uploader une image de votre choix avec le bouton upload puis lancer une prédiction. Cela va uploader l'image dans le frontend, puis envoyer une requête POST à <code>http://url-du-serveur/predict</code> puis récupérer les résultats (le <code>json</code>) et l'interpréter correctement.</p>
<p>Vous noterez que nous avons démarré le frontend avec l'argument <code>--network="host"</code>. Cela permet au container d'avoir accès au <code>localhost</code> (d'être sur le même réseau que l'hôte). Sans cet argument, les containers sont sur des réseaux séparés et ne se voient pas.</p>
<p>Vous pouvez maintenant stopper les deux containers (backend et frontend)</p>
<h2 id="5-docker-compose">5 - docker-compose<a class="headerlink" href="#5-docker-compose" title="Permanent link">🔗</a></h2>
<p>Pour simplifier cette étape de déploiement multi-containers qui peut être fastidieuse (imaginez une application à 4, 5 containers !), une solution nommée <code>docker-compose</code> existe. Voir une <a href="https://blog.stephane-robert.info/docs/conteneurs/orchestrateurs/docker-compose/">introduction à docker-compose</a></p>
<p>Cette solution permet de lancer une série de containers en les assignant à un même réseau, de façon déclarative, c'est à dire que l'on renseigne dans un fichier de configuration la mise en place des containers.</p>
<p>Notre <code>docker-compose.yml</code> se trouve dans le dossier <code>tp-deployment</code></p>
<div class="highlight"><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3&#39;</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">yolo</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;eu.gcr.io/third-ridge-138414/yolo-v5:1.2&quot;</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8000:8000&quot;</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yolo</span>
<span class="w">  </span><span class="nt">streamlit</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;eu.gcr.io/third-ridge-138414/yolo-v5-streamlit:1.5&quot;</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;8501:8501&quot;</span>
<span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">streamlit</span>
</code></pre></div>
<p>Ce fichier de configuration indique qu'au lancement le frontend et le backend vont se lancer simultanément, exposer leurs ports respectifs, et pouvoir communiquer entre eux via leurs "hostnames".</p>
<p>Nous allons lancer notre application par ce bias en lançant la commande <code>docker-compose up</code></p>
<p>Voir doc docker-compose : <a href="https://docs.docker.com/compose/reference/">https://docs.docker.com/compose/reference/</a></p>
<p>Cela va directement démarrer nos deux services, que vous pouvez retrouver sur les ports 8000 (backend) et 8501 (frontend)</p>
<p>Comme précédemment, vous pouvez vous connecter au frontend sur le port 8501 du codespace pour interagir directement avec le backend. La petite nuance est que ce backend est disponible sur <code>http://yolo:8000</code> plutôt que <code>http://localhost:8000</code> car le <code>docker-compose</code> a nommé les containers avec un hostname correspondant à celui spécifié (et les a mis en réseau)</p>
<p>Une fois que vous avez interagi avec votre déploiement, nous allons maintenant déployer le backend sur un serveur sur google cloud.</p>
<h2 id="6-deploiement-du-backend-sur-une-vm-google-compute-engine">6 - Deploiement du backend sur une VM Google Compute Engine<a class="headerlink" href="#6-deploiement-du-backend-sur-une-vm-google-compute-engine" title="Permanent link">🔗</a></h2>
<p>Nous allons maintenant démarrer une instance de VM Google Compute Engine et directement y déployer un container. Vous avez déjà vu cette méthode dans la <a href="https://supaerodatascience.github.io/DE/1_4_be.html#64-deployment-in-a-vm">section streamlit du BE</a></p>
<p>N'oubliez pas de connecter votre github codespace à votre projet gcp en utilisant <code>gcloud init</code></p>
<p>Récupérez votre project_id gcp :  `PROJECT_ID=$(gcloud config get-value project 2&gt; /dev/null)``</p>
<p>Puis nous allons créer directement une VM en y déployant un container. Notez que l'on utilise cette fois un OS dédié à l'hébergement de containers (pas prévu pour s'y connecter en ssh) plutôt qu'ubuntu comme précédemment. </p>
<div class="highlight"><pre><span></span><code>gcloud<span class="w"> </span>compute<span class="w"> </span>instances<span class="w"> </span>create-with-container<span class="w"> </span>fch-yolo-backend<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--project<span class="o">=</span><span class="si">${</span><span class="nv">PROJECT_ID</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--zone<span class="o">=</span>europe-west1-b<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--machine-type<span class="o">=</span>n1-standard-2<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--image<span class="o">=</span>projects/cos-cloud/global/images/cos-stable-109-17800-66-27<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--boot-disk-size<span class="o">=</span>20GB<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--boot-disk-type<span class="o">=</span>pd-standard<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--container-image<span class="o">=</span>eu.gcr.io/third-ridge-138414/yolo-v5:1.2<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--container-restart-policy<span class="o">=</span>always
</code></pre></div>
<p>Note : Si vous utilisez votre propre projet GCP, vous devez ouvrir le port 8000 à internet public pour pouvoir y accéder. Utilisez cette commande : </p>
<div class="highlight"><pre><span></span><code>gcloud<span class="w"> </span>compute<span class="w"> </span>--project<span class="o">=</span><span class="si">${</span><span class="nv">PROJECT_ID</span><span class="si">}</span><span class="w"> </span>firewall-rules<span class="w"> </span>create<span class="w"> </span>open-8000<span class="w"> </span>--direction<span class="o">=</span>INGRESS<span class="w"> </span>--priority<span class="o">=</span><span class="m">1000</span><span class="w"> </span>--network<span class="o">=</span>default<span class="w"> </span>--action<span class="o">=</span>ALLOW<span class="w"> </span>--rules<span class="o">=</span>tcp:8000<span class="w"> </span>--source-ranges<span class="o">=</span><span class="m">0</span>.0.0.0/0<span class="w"> </span>
</code></pre></div>
<h2 id="7-tests">7 - Tests<a class="headerlink" href="#7-tests" title="Permanent link">🔗</a></h2>
<p>Nous allons maintenant tester que notre backend est bien déployé. Il faut pour cela relancer le front-end et changer l'IP pour l'IP de la machine virtuelle précédemment lancée</p>
<ul>
<li>relancez le docker du frontend <code>docker run --rm -p 8501:8501 eu.gcr.io/third-ridge-138414/yolo-v5-streamlit:1.5</code></li>
<li>connectez vous au port 8501 du github codespace, comme précédemment, et modifiez l'IP du backend pour qu'il corresponde à celle du serveur distant (toujours sur le port 8000)</li>
<li>si vous envoyez une requête, elle est maintenant transmise au backend !</li>
</ul>
<h2 id="8-yay">8. Yay !<a class="headerlink" href="#8-yay" title="Permanent link">🔗</a></h2>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>🍾 <em>Et voilà, vous avez déployé votre premier modèle sur le cloud</em></p>
</div>
<p>N'oubliez pas de supprimer votre VM GCP une fois le travail terminé</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["toc.autohide", "navigation.sections"], "search": "assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>